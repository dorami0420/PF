<div class="rooms">

<% current_user.rooms.each do |room| %>

 <div class="room">
 <div class="room-name">
<% @another_user = (room.users.where.not(id: current_user.id).to_a)[0] %>
<%= link_to @another_user.nickname, room_messages_path(room) %>
 </div>
 </div>

<% end %>

</div>


<%= form_with model: [@room, @message], html: {class: "form"},

local: true do |f|%>

 <div class="form-input">

<%= f.text_field :content, class: 'form-message',

placeholder: 'メッセージを入力してください' %>

 <label class="form-image">

 <span class="image-file">画像</span>

<%= f.file_field :image, class: 'hidden' %>

 </label>

 </div>

<%= f.submit '送信', class: 'form-submit' %>

<% end %>

<div class="messages">

<%= render partial: 'message', collection: @messages %>

</div>
<div class="message">

 <div class="upper-message">

 <div class="message-user">

<%= message.user.nickname%>

 </div>

 <div class="message-date">

<%= l message.created_at%>

 </div>

 </div>

 <div class="lower-message">

 <div class="message-content">
   <%= message.content%>

 </div>

<%= image_tag message.image.variant(resize:'500x500'), 

class: 'message-image' if message.image.attached? %>

 </div>

</div>
 
 <script type="text/javascript">

const $scrollAuto = $('.messages');

$scrollAuto.animate({scrollTop: ($scrollAuto[0].scrollHeight + 1000)}, 'fast')

</script> 